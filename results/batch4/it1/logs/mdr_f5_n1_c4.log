/opt/slurm/22.05.3/var/slurm/job127188/slurm_script: line 20: module: command not found

------------------
Running STARTSPARK.py
------------------

-- Creating spark instances
-- Creating tmp directories and throing spark instance in 192.168.3.82
rm: cannot remove '/tmp/spark/logs': No such file or directory
rm: cannot remove '/tmp/spark/work': No such file or directory
load singularity/3.9.6 (PATH)
INFO:    Converting SIF file to temporary sandbox...
is a directory

INFO:    instance started successfully
-- Creating tmp directories and starting spark instance in 192.168.3.81
rm: cannot remove '/tmp/spark/logs': No such file or directory
rm: cannot remove '/tmp/spark/work': No such file or directory
load singularity/3.9.6 (PATH)
INFO:    Converting SIF file to temporary sandbox...
is a directory

INFO:    instance started successfully
-- Starting MASTER
load singularity/3.9.6 (PATH)
is a directory
starting org.apache.spark.deploy.master.Master, logging to /opt/spark/logs/spark-ggomez-org.apache.spark.deploy.master.Master-1-arriesgado-3.out
failed to launch: nice -n 0 /opt/spark/bin/spark-class org.apache.spark.deploy.master.Master --host 192.168.3.81 --port 7078 --webui-port 8081
full log in /opt/spark/logs/spark-ggomez-org.apache.spark.deploy.master.Master-1-arriesgado-3.out
-- Starting WORKER 192.168.3.82
load singularity/3.9.6 (PATH)
is a directory
starting org.apache.spark.deploy.worker.Worker, logging to /opt/spark/logs/spark-ggomez-org.apache.spark.deploy.worker.Worker-1-arriesgado-4.out
failed to launch: nice -n 0 /opt/spark/bin/spark-class org.apache.spark.deploy.worker.Worker --webui-port 8082 192.168.3.81:7078 --cores 4
full log in /opt/spark/logs/spark-ggomez-org.apache.spark.deploy.worker.Worker-1-arriesgado-4.out


------------------
STARTSPARK.py done!
------------------

copying epistasis input to node 192.168.3.82
load singularity/3.9.6 (PATH)
is a directory
23/03/21 13:03:15 WARN Utils: Your hostname, arriesgado-3 resolves to a loopback address: 127.0.1.1; using 192.168.3.81 instead (on interface eth0)
23/03/21 13:03:15 WARN Utils: Set SPARK_LOCAL_IP if you need to bind to another address
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by org.apache.spark.unsafe.Platform (file:/opt/spark/jars/spark-unsafe_2.12-3.1.1.jar) to constructor java.nio.DirectByteBuffer(long,int)
WARNING: Please consider reporting this to the maintainers of org.apache.spark.unsafe.Platform
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
23/03/21 13:03:36 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
Using Spark's default log4j profile: org/apache/spark/log4j-defaults.properties
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
[Stage 0:>                                                          (0 + 0) / 1][Stage 0:>                                                          (0 + 1) / 1][Stage 0:>                                                          (0 + 1) / 1]                                                                                [Stage 1:>                                                          (0 + 0) / 1][Stage 1:>                                                          (0 + 1) / 1]                                                                                [Stage 2:>                                                          (0 + 2) / 2][Stage 2:===========================================================(2 + 0) / 2]                                                                                [Stage 3:>                                                          (0 + 1) / 1]                                                                                [Stage 4:>                                                          (0 + 1) / 1][Stage 4:===========================================================(1 + 0) / 1]                                                                                [Stage 5:>                                                          (0 + 2) / 2]                                                                                [Stage 6:>                                                          (0 + 1) / 1]                                                                                [Stage 7:>                                                          (0 + 1) / 1]                                                                                [Stage 8:>                                                          (0 + 4) / 4][Stage 8:==============>                                            (1 + 3) / 4][Stage 8:=============================>                             (2 + 2) / 4]                                                                                [Stage 9:>                                                          (0 + 4) / 4][Stage 9:==============>                                            (1 + 3) / 4]                                                                                [Stage 10:>                                                         (0 + 0) / 4][Stage 10:>                                                         (0 + 4) / 4][Stage 10:==============>                                           (1 + 3) / 4][Stage 10:===========================================>              (3 + 1) / 4]                                                                                [Stage 11:>                                                         (0 + 1) / 1]                                                                                [Stage 12:>                                                         (0 + 1) / 1]                                                                                [Stage 13:>                                                         (0 + 4) / 4][Stage 13:==============>                                           (1 + 3) / 4][Stage 13:===========================================>              (3 + 1) / 4]                                                                                [Stage 14:>                                                         (0 + 4) / 4][Stage 14:==============>                                           (1 + 3) / 4][Stage 14:=============================>                            (2 + 2) / 4]                                                                                [Stage 15:>                                                         (0 + 0) / 4][Stage 15:>                                                         (0 + 3) / 4][Stage 15:>                                                         (0 + 4) / 4][Stage 15:==============>                                           (1 + 3) / 4][Stage 15:===========================================>              (3 + 1) / 4]                                                                                [Stage 16:>                                                         (0 + 1) / 1]                                                                                [Stage 17:>                                                         (0 + 1) / 1]                                                                                [Stage 18:>                                                         (0 + 4) / 4][Stage 18:==============>                                           (1 + 3) / 4]                                                                                [Stage 19:>                                                         (0 + 4) / 4][Stage 19:==============>                                           (1 + 3) / 4][Stage 19:===========================================>              (3 + 1) / 4]                                                                                [Stage 20:>                                                         (0 + 0) / 4][Stage 20:>                                                         (0 + 4) / 4][Stage 20:==============>                                           (1 + 3) / 4][Stage 20:=============================>                            (2 + 2) / 4]                                                                                [Stage 21:>                                                         (0 + 1) / 1]                                                                                [Stage 22:>                                                         (0 + 1) / 1]                                                                                [Stage 23:>                                                         (0 + 4) / 4][Stage 23:==============>                                           (1 + 3) / 4]                                                                                [Stage 24:>                                                         (0 + 4) / 4][Stage 24:==============>                                           (1 + 3) / 4][Stage 24:=============================>                            (2 + 2) / 4]                                                                                [Stage 25:>                                                         (0 + 0) / 4][Stage 25:>                                                         (0 + 4) / 4][Stage 25:==============>                                           (1 + 3) / 4][Stage 25:===========================================>              (3 + 1) / 4]                                                                                [Stage 26:>                                                         (0 + 1) / 1]                                                                                [Stage 27:>                                                         (0 + 1) / 1]                                                                                [Stage 28:>                                                         (0 + 4) / 4][Stage 28:==============>                                           (1 + 3) / 4][Stage 28:=============================>                            (2 + 2) / 4][Stage 28:===========================================>              (3 + 1) / 4]                                                                                [Stage 29:>                                                         (0 + 4) / 4][Stage 29:==============>                                           (1 + 3) / 4][Stage 29:=============================>                            (2 + 2) / 4]                                                                                [Stage 30:>                                                         (0 + 0) / 4][Stage 30:>                                                         (0 + 3) / 4][Stage 30:>                                                         (0 + 4) / 4][Stage 30:==============>                                           (1 + 3) / 4][Stage 30:===========================================>              (3 + 1) / 4]                                                                                [Stage 31:>                                                         (0 + 1) / 1]                                                                                [Stage 32:>                                                         (0 + 1) / 1]                                                                                [Stage 33:>                                                         (0 + 2) / 2][Stage 33:=============================>                            (1 + 1) / 2]                                                                                [Stage 34:>                                                         (0 + 1) / 1]                                                                                [Stage 35:>                                                         (0 + 1) / 1]                                                                                [Stage 36:>                                                         (0 + 4) / 4][Stage 36:==============>                                           (1 + 3) / 4][Stage 36:===========================================>              (3 + 1) / 4]                                                                                [Stage 37:>                                                         (0 + 4) / 4][Stage 37:==============>                                           (1 + 3) / 4][Stage 37:=============================>                            (2 + 2) / 4][Stage 37:==========================================================(4 + 0) / 4]                                                                                [Stage 38:>                                                         (0 + 0) / 4][Stage 38:>                                                         (0 + 4) / 4][Stage 38:==============>                                           (1 + 3) / 4]                                                                                [Stage 39:>                                                         (0 + 1) / 1]                                                                                [Stage 40:>                                                         (0 + 1) / 1]                                                                                [Stage 41:>                                                         (0 + 4) / 4][Stage 41:==============>                                           (1 + 3) / 4]                                                                                [Stage 42:>                                                         (0 + 4) / 4][Stage 42:==============>                                           (1 + 3) / 4][Stage 42:=============================>                            (2 + 2) / 4]                                                                                [Stage 43:>                                                         (0 + 0) / 4][Stage 43:>                                                         (0 + 2) / 4][Stage 43:>                                                         (0 + 4) / 4][Stage 43:==============>                                           (1 + 3) / 4]                                                                                [Stage 44:>                                                         (0 + 1) / 1]                                                                                [Stage 45:>                                                         (0 + 1) / 1]                                                                                [Stage 46:>                                                         (0 + 4) / 4][Stage 46:==============>                                           (1 + 3) / 4][Stage 46:=============================>                            (2 + 2) / 4]                                                                                [Stage 47:>                                                         (0 + 4) / 4][Stage 47:==============>                                           (1 + 3) / 4][Stage 47:=============================>                            (2 + 2) / 4]                                                                                [Stage 48:>                                                         (0 + 0) / 4][Stage 48:>                                                         (0 + 4) / 4][Stage 48:==============>                                           (1 + 3) / 4][Stage 48:=============================>                            (2 + 2) / 4]                                                                                [Stage 49:>                                                         (0 + 1) / 1]                                                                                [Stage 50:>                                                         (0 + 1) / 1]                                                                                [Stage 51:>                                                         (0 + 4) / 4][Stage 51:==============>                                           (1 + 3) / 4][Stage 51:=============================>                            (2 + 2) / 4]                                                                                [Stage 52:>                                                         (0 + 4) / 4][Stage 52:==============>                                           (1 + 3) / 4][Stage 52:=============================>                            (2 + 2) / 4]                                                                                [Stage 53:>                                                         (0 + 0) / 4][Stage 53:>                                                         (0 + 4) / 4][Stage 53:=============================>                            (2 + 2) / 4][Stage 53:==========================================================(4 + 0) / 4]                                                                                [Stage 54:>                                                         (0 + 1) / 1]                                                                                [Stage 55:>                                                         (0 + 1) / 1][Stage 55:==========================================================(1 + 0) / 1]                                                                                [Stage 56:>                                                         (0 + 2) / 2]                                                                                [Stage 57:>                                                         (0 + 1) / 1]                                                                                [Stage 58:>                                                         (0 + 1) / 1]                                                                                [Stage 59:>                                                         (0 + 4) / 4][Stage 59:==============>                                           (1 + 3) / 4][Stage 59:===========================================>              (3 + 1) / 4]                                                                                [Stage 60:>                                                         (0 + 4) / 4][Stage 60:==============>                                           (1 + 3) / 4]                                                                                [Stage 61:>                                                         (0 + 0) / 4][Stage 61:>                                                         (0 + 4) / 4][Stage 61:==============>                                           (1 + 3) / 4][Stage 61:===========================================>              (3 + 1) / 4][Stage 61:==========================================================(4 + 0) / 4]                                                                                [Stage 62:>                                                         (0 + 1) / 1]                                                                                [Stage 63:>                                                         (0 + 1) / 1]                                                                                [Stage 64:>                                                         (0 + 4) / 4][Stage 64:==============>                                           (1 + 3) / 4]                                                                                [Stage 65:>                                                         (0 + 4) / 4][Stage 65:==============>                                           (1 + 3) / 4][Stage 65:===========================================>              (3 + 1) / 4]                                                                                [Stage 66:>                                                         (0 + 0) / 4][Stage 66:>                                                         (0 + 4) / 4][Stage 66:==============>                                           (1 + 3) / 4]                                                                                [Stage 67:>                                                         (0 + 1) / 1]                                                                                [Stage 68:>                                                         (0 + 1) / 1]                                                                                [Stage 69:>                                                         (0 + 4) / 4][Stage 69:==============>                                           (1 + 3) / 4][Stage 69:=============================>                            (2 + 2) / 4]                                                                                [Stage 70:>                                                         (0 + 4) / 4][Stage 70:==============>                                           (1 + 3) / 4][Stage 70:===========================================>              (3 + 1) / 4]                                                                                [Stage 71:>                                                         (0 + 0) / 4][Stage 71:>                                                         (0 + 4) / 4][Stage 71:==============>                                           (1 + 3) / 4][Stage 71:=============================>                            (2 + 2) / 4]                                                                                [Stage 72:>                                                         (0 + 1) / 1]                                                                                [Stage 73:>                                                         (0 + 1) / 1]                                                                                [Stage 74:>                                                         (0 + 2) / 2][Stage 74:=============================>                            (1 + 1) / 2]                                                                                [Stage 75:>                                                         (0 + 1) / 1]                                                                                [Stage 76:>                                                         (0 + 1) / 1]                                                                                [Stage 77:>                                                         (0 + 4) / 4][Stage 77:==============>                                           (1 + 3) / 4][Stage 77:=============================>                            (2 + 2) / 4]                                                                                [Stage 78:>                                                         (0 + 4) / 4][Stage 78:==============>                                           (1 + 3) / 4][Stage 78:===========================================>              (3 + 1) / 4]                                                                                [Stage 79:>                                                         (0 + 0) / 4][Stage 79:>                                                         (0 + 3) / 4][Stage 79:>                                                         (0 + 4) / 4][Stage 79:==============>                                           (1 + 3) / 4][Stage 79:=============================>                            (2 + 2) / 4][Stage 79:===========================================>              (3 + 1) / 4]                                                                                [Stage 80:>                                                         (0 + 1) / 1]                                                                                [Stage 81:>                                                         (0 + 1) / 1]                                                                                [Stage 82:>                                                         (0 + 4) / 4][Stage 82:==============>                                           (1 + 3) / 4][Stage 82:===========================================>              (3 + 1) / 4]                                                                                [Stage 83:>                                                         (0 + 4) / 4][Stage 83:==============>                                           (1 + 3) / 4][Stage 83:===========================================>              (3 + 1) / 4]                                                                                [Stage 84:>                                                         (0 + 0) / 4][Stage 84:>                                                         (0 + 3) / 4][Stage 84:>                                                         (0 + 4) / 4][Stage 84:==============>                                           (1 + 3) / 4][Stage 84:=============================>                            (2 + 2) / 4]                                                                                [Stage 85:>                                                         (0 + 1) / 1]                                                                                [Stage 86:>                                                         (0 + 1) / 1]                                                                                [Stage 87:>                                                         (0 + 2) / 2][Stage 87:==========================================================(2 + 0) / 2]                                                                                [Stage 88:>                                                         (0 + 1) / 1]                                                                                [Stage 89:>                                                         (0 + 1) / 1]                                                                                [Stage 90:>                                                         (0 + 4) / 4][Stage 90:==============>                                           (1 + 3) / 4][Stage 90:===========================================>              (3 + 1) / 4]                                                                                [Stage 91:>                                                         (0 + 4) / 4][Stage 91:==============>                                           (1 + 3) / 4][Stage 91:=============================>                            (2 + 2) / 4][Stage 91:===========================================>              (3 + 1) / 4]                                                                                [Stage 92:>                                                         (0 + 0) / 4][Stage 92:>                                                         (0 + 4) / 4][Stage 92:=============================>                            (2 + 2) / 4][Stage 92:==========================================================(4 + 0) / 4]                                                                                
--------------------------------
--- STARTING sparkmdr_x86.py ---
--------------------------------

Number of files to be processed 5.
Number of cores set to 4.
Number of partitions of the rdd set to 2.
Number of nodes set to 1.
Connected with spartk
Patients read
Ration cases/controls: 0.8768718801996672
List of files obtained.

----- RUNNING 5 FILES -----

Loading main file chr22_NuGENE0000.gz
File loaded in :  26.51861555315554
RDD1 partitions: 2
RDD1 variants: 50
Processing secondary file chr22_NuGENE0000.gz
File 2 loaded.
Applying MDR...
MDR applied to: 2500 pairs.
Saving data...
Data saved.

Processing secondary file chr22_NuGENE0001.gz
File 2 loaded.
Applying MDR...
MDR applied to: 2500 pairs.
Saving data...
Data saved.

Processing secondary file chr22_NuGENE0002.gz
File 2 loaded.
Applying MDR...
MDR applied to: 2500 pairs.
Saving data...
Data saved.

Processing secondary file chr22_NuGENE0003.gz
File 2 loaded.
Applying MDR...
MDR applied to: 2500 pairs.
Saving data...
Data saved.

Processing secondary file chr22_NuGENE0004.gz
File 2 loaded.
Applying MDR...
MDR applied to: 2500 pairs.
Saving data...
Data saved.

Combined main file chr22_NuGENE0000.gz in: 493.6556864012964
------------------------------------------

Loading main file chr22_NuGENE0001.gz
File loaded in :  15.835032768081874
RDD1 partitions: 2
RDD1 variants: 50
Processing secondary file chr22_NuGENE0000.gz
Skipping file. mdr_chr22_NuGENE0000_chr22_NuGENE0001 already processed.
Processing secondary file chr22_NuGENE0001.gz
File 2 loaded.
Applying MDR...
MDR applied to: 2500 pairs.
Saving data...
Data saved.

Processing secondary file chr22_NuGENE0002.gz
File 2 loaded.
Applying MDR...
MDR applied to: 2500 pairs.
Saving data...
Data saved.

Processing secondary file chr22_NuGENE0003.gz
File 2 loaded.
Applying MDR...
MDR applied to: 2500 pairs.
Saving data...
Data saved.

Processing secondary file chr22_NuGENE0004.gz
File 2 loaded.
Applying MDR...
MDR applied to: 2500 pairs.
Saving data...
Data saved.

Combined main file chr22_NuGENE0001.gz in: 381.6915385648608
------------------------------------------

Loading main file chr22_NuGENE0002.gz
File loaded in :  15.800878695677966
RDD1 partitions: 2
RDD1 variants: 50
Processing secondary file chr22_NuGENE0000.gz
Skipping file. mdr_chr22_NuGENE0000_chr22_NuGENE0002 already processed.
Processing secondary file chr22_NuGENE0001.gz
Skipping file. mdr_chr22_NuGENE0001_chr22_NuGENE0002 already processed.
Processing secondary file chr22_NuGENE0002.gz
File 2 loaded.
Applying MDR...
MDR applied to: 2500 pairs.
Saving data...
Data saved.

Processing secondary file chr22_NuGENE0003.gz
File 2 loaded.
Applying MDR...
MDR applied to: 2500 pairs.
Saving data...
Data saved.

Processing secondary file chr22_NuGENE0004.gz
File 2 loaded.
Applying MDR...
MDR applied to: 2500 pairs.
Saving data...
Data saved.

Combined main file chr22_NuGENE0002.gz in: 297.1565837706439
------------------------------------------

Loading main file chr22_NuGENE0003.gz
File loaded in :  15.97006071638316
RDD1 partitions: 2
RDD1 variants: 50
Processing secondary file chr22_NuGENE0000.gz
Skipping file. mdr_chr22_NuGENE0000_chr22_NuGENE0003 already processed.
Processing secondary file chr22_NuGENE0001.gz
Skipping file. mdr_chr22_NuGENE0001_chr22_NuGENE0003 already processed.
Processing secondary file chr22_NuGENE0002.gz
Skipping file. mdr_chr22_NuGENE0002_chr22_NuGENE0003 already processed.
Processing secondary file chr22_NuGENE0003.gz
File 2 loaded.
Applying MDR...
MDR applied to: 2500 pairs.
Saving data...
Data saved.

Processing secondary file chr22_NuGENE0004.gz
File 2 loaded.
Applying MDR...
MDR applied to: 2500 pairs.
Saving data...
Data saved.

Combined main file chr22_NuGENE0003.gz in: 197.98056899337098
------------------------------------------

Loading main file chr22_NuGENE0004.gz
File loaded in :  15.848103058990091
RDD1 partitions: 2
RDD1 variants: 50
Processing secondary file chr22_NuGENE0000.gz
Skipping file. mdr_chr22_NuGENE0000_chr22_NuGENE0004 already processed.
Processing secondary file chr22_NuGENE0001.gz
Skipping file. mdr_chr22_NuGENE0001_chr22_NuGENE0004 already processed.
Processing secondary file chr22_NuGENE0002.gz
Skipping file. mdr_chr22_NuGENE0002_chr22_NuGENE0004 already processed.
Processing secondary file chr22_NuGENE0003.gz
Skipping file. mdr_chr22_NuGENE0003_chr22_NuGENE0004 already processed.
Processing secondary file chr22_NuGENE0004.gz
File 2 loaded.
Applying MDR...
MDR applied to: 2500 pairs.
Saving data...
Data saved.

Combined main file chr22_NuGENE0004.gz in: 106.86877815192565
------------------------------------------

Running time: 1477.3535198820755
Total time: 2008.4265329870395
Total pairs processed: 37500
/opt/slurm/22.05.3/var/slurm/job127188/slurm_script: line 38: module: command not found

-------------------
Running STOPSPARK.py
-------------------

-- Stopping MASTER 192.168.3.81
bash: line 1: singularity: command not found
Stopping WORKER 192.168.3.82
bash: line 1: singularity: command not found
-- Stopping singularity instance
bash: line 1: singularity: command not found

-------------------
STOPSPARK.py done!
-------------------

*************
JSCRIPT DONE!
*************
